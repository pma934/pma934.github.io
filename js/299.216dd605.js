"use strict";(self["webpackChunkblog"]=self["webpackChunkblog"]||[]).push([[299],{4299:function(e,t,o){o.r(t),o.d(t,{default:function(){return oe}});o(7658);var l=o(5309);const r=e=>((0,l.pushScopeId)("data-v-0cdacb40"),e=e(),(0,l.popScopeId)(),e),s={class:"header-wrap"},a=["src"],i={class:"header-container"},n={class:"title"},c=["src"],d={class:"name-time-labels"},m={class:"name-time"},g={class:"name"},h={class:"time"},u={class:"labels"},f={class:"markdown-body"},p=["innerHTML"],v={class:"end"},b=r((()=>(0,l.createElementVNode)("span",{class:"text"},"END!",-1))),N={key:0,class:"license markdown-body"},y=["href"],V=r((()=>(0,l.createElementVNode)("br",null,null,-1))),E=r((()=>(0,l.createElementVNode)("span",null,[(0,l.createTextVNode)("许可协议："),(0,l.createElementVNode)("a",{href:"https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh"},"知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议")],-1))),k={class:"archive-content-footer"},B={class:"footer-wrap"},T=["src"],x={class:"text previous"},D=r((()=>(0,l.createElementVNode)("div",{class:"previous-label"},"previous",-1))),I={class:"previous-title"},w=["src"],C={class:"text next"},L=r((()=>(0,l.createElementVNode)("div",{class:"next-label"},"next",-1))),S={class:"next-title"};function $(e,t,o,r,$,H){const O=(0,l.resolveComponent)("el-image"),z=(0,l.resolveComponent)("Pikachu"),_=(0,l.resolveComponent)("ArchiveDirectory");return(0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,null,[(0,l.createElementVNode)("div",{class:(0,l.normalizeClass)(["archive-content-header",$.loading?"loading":""])},[(0,l.createElementVNode)("div",s,[(0,l.createVNode)(O,{class:"img",src:H.img||$.loadingImg,fit:"cover",loading:"lazy"},{placeholder:(0,l.withCtx)((()=>[(0,l.createElementVNode)("img",{class:"img",src:$.loadingImg},null,8,a)])),_:1},8,["src"]),(0,l.createElementVNode)("header",i,[(0,l.createElementVNode)("div",n,[(0,l.createElementVNode)("div",{ref:"title-text",class:(0,l.normalizeClass)(["title-text",$.titleScroll?"scroll":""])},[(0,l.createElementVNode)("span",null,(0,l.toDisplayString)(H.title),1)],2)]),(0,l.createElementVNode)("img",{class:"avatar",src:H.avatar},null,8,c),(0,l.createElementVNode)("div",d,[(0,l.createElementVNode)("div",m,[(0,l.createElementVNode)("div",g,(0,l.toDisplayString)(H.name),1),(0,l.createElementVNode)("div",h,(0,l.toDisplayString)(H.time),1)]),(0,l.createElementVNode)("div",u,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(H.labels,(e=>((0,l.openBlock)(),(0,l.createElementBlock)("span",{key:e.name},(0,l.toDisplayString)(e.name),1)))),128))])])])])],2),(0,l.createElementVNode)("div",{class:(0,l.normalizeClass)(["archive-content",$.loading?"loading":""])},[(0,l.createElementVNode)("div",f,[(0,l.createElementVNode)("div",{ref:"blog",innerHTML:H.blogHtml},null,8,p)]),(0,l.createElementVNode)("div",v,[(0,l.createVNode)(z),b]),H.blog?((0,l.openBlock)(),(0,l.createElementBlock)("div",N,[(0,l.createElementVNode)("span",null,[(0,l.createTextVNode)("原始链接："),(0,l.createElementVNode)("a",{href:H.blog.url},(0,l.toDisplayString)(H.blog.url),9,y)]),V,E])):(0,l.createCommentVNode)("",!0)],2),(0,l.createElementVNode)("div",k,[(0,l.createElementVNode)("div",B,[H.lastBlog?((0,l.openBlock)(),(0,l.createElementBlock)("div",{key:0,onClick:t[0]||(t[0]=t=>e.$router.push(`/archive/${H.lastBlog.number}`)),class:"router"},[(0,l.createVNode)(O,{class:"background",src:H.lastBlog.img,fit:"cover",loading:"lazy"},{placeholder:(0,l.withCtx)((()=>[(0,l.createElementVNode)("img",{class:"img",src:$.loadingImg},null,8,T)])),_:1},8,["src"]),(0,l.createElementVNode)("div",x,[D,(0,l.createElementVNode)("div",I,(0,l.toDisplayString)(H.lastBlog.title),1)])])):(0,l.createCommentVNode)("",!0),H.nextBlog?((0,l.openBlock)(),(0,l.createElementBlock)("div",{key:1,onClick:t[1]||(t[1]=t=>e.$router.push(`/archive/${H.nextBlog.number}`)),class:"router"},[(0,l.createVNode)(O,{class:"background",src:H.nextBlog.img,fit:"cover",loading:"lazy"},{placeholder:(0,l.withCtx)((()=>[(0,l.createElementVNode)("img",{class:"img",src:$.loadingImg},null,8,w)])),_:1},8,["src"]),(0,l.createElementVNode)("div",C,[L,(0,l.createElementVNode)("div",S,(0,l.toDisplayString)(H.nextBlog.title),1)])])):(0,l.createCommentVNode)("",!0)])]),$.directoryNumber?((0,l.openBlock)(),(0,l.createBlock)(_,{key:0,directory:$.directory,"active-id":$.activeId,class:(0,l.normalizeClass)(["directory",$.loading?"loading":""])},null,8,["directory","active-id","class"])):(0,l.createCommentVNode)("",!0)],64)}var H=o(3195),O=o(4974);const z=e=>((0,l.pushScopeId)("data-v-0b16e839"),e=e(),(0,l.popScopeId)(),e),_={class:"markdown-directory"},A={class:"markdown-directory-content"},M=z((()=>(0,l.createElementVNode)("div",{class:"title"},"目录",-1))),Z={class:"body"},P=["innerHTML"];function F(e,t,o,r,s,a){const i=(0,l.resolveComponent)("el-scrollbar");return(0,l.openBlock)(),(0,l.createElementBlock)("div",_,[(0,l.createElementVNode)("div",A,[M,(0,l.createVNode)(i,{height:"460"},{default:(0,l.withCtx)((()=>[(0,l.createElementVNode)("div",Z,[(0,l.createElementVNode)("div",{innerHTML:o.directory,onClick:t[0]||(t[0]=(...e)=>a.tagTo&&a.tagTo(...e)),ref:"directory"},null,8,P)])])),_:1})])])}var G={data(){return{selectDom:null}},props:{directory:{type:String,default:""},activeId:{type:String,default:""}},methods:{tagTo(e){const t=e.srcElement.dataset.id;document.getElementById(t).scrollIntoView()},select(e){this.selectDom&&(this.selectDom.dataset.active=!1);const t=Array.from(this.$refs.directory.children).find((t=>t.dataset.id===e));t.dataset.active=!0,t.scrollIntoView({block:"center"}),this.selectDom=t}},watch:{activeId(e){this.select(e)}}},J=o(89);const U=(0,J.Z)(G,[["render",F],["__scopeId","data-v-0b16e839"]]);var W=U,j=o(9843);const q=function(e){return e.offsetParent?e.offsetTop+q(e.offsetParent):e.offsetTop},R={class:"pikachu"};function K(e,t,o,r,s,a){return(0,l.openBlock)(),(0,l.createElementBlock)("div",R)}var Q={name:"OneCat"};const X=(0,J.Z)(Q,[["render",K],["__scopeId","data-v-222591f3"]]);var Y=X,ee={components:{ArchiveDirectory:W,Pikachu:Y},data(){return{directory:null,offsetTopList:[],activeId:"",loadingImg:new URL(o(265),o.b).href,userData:null,titleScroll:!1,getOffsetTopListIsDoing:!0,resize:0,loading:!0,directoryNumber:0}},props:{number:{type:String,require:!0}},computed:{blog(){return this.$store.getters.getBlogById(+this.number)},blogHtml(){return this.blog?.blogHtml??""},title(){return this.blog?.title??""},time(){return this.blog?.time??""},labels(){return this.blog?.labels??[]},img(){return this.blog?.img??""},avatar(){return this.userData?.avatar_url??""},name(){return this.userData?.name??""},nextBlog(){return this.blog?this.$store.getters.getNextBlog(this.blog):null},lastBlog(){return this.blog?this.$store.getters.getLastBlog(this.blog):null}},async created(){this.$store.dispatch("checkUserData").then((e=>{e&&(this.userData=e)})),await this.getBlog(),await this.getDirectory(),await this.getOffsetTopList(),this.loading=!1,j.Z.on("scroll",(e=>{for(let t of this.offsetTopList){if(!(+t.offsetTop<=+e))break;this.activeId=t.id}}))},async mounted(){await this.$nextTick();const e=this.$refs["title-text"].offsetWidth,t=this.$refs["title-text"].parentNode.offsetWidth;e>t&&(this.titleScroll=!0)},updated(){this.resize=this.$refs.blog.offsetHeight},methods:{async getBlog(){if(!this.blog){const e=await(0,H.x3)({number:this.number});if(e?.data){const t=new O.Z(e.data);this.$store.commit("setBlogs",[[+this.number,t]])}}},async getDirectory(){let e=document.createElement("div");e.innerHTML=this.blog.blogHtml;let t=Array.from(e.children).filter((e=>["H2","H3"].includes(e.tagName)));this.directoryNumber=t.length,this.directory=t.map((e=>{const t=e.getAttribute("id"),o="H2"===e.tagName?"h2":"h3";return`<a data-id="${t}" class="${o}">${t}</a>`})).join(""),e=null,t=null},async getOffsetTopList(){const e=Array.from(this.$refs.blog.children).filter((e=>["H2","H3"].includes(e.tagName))).map((e=>({id:e.id,offsetTop:q(e)-60-this.$store.state.headerOffset})));JSON.stringify(this.offsetTopList)!==JSON.stringify(e)?(this.offsetTopList=e,this.getOffsetTopListIsDoing=!0,setTimeout((()=>{this.getOffsetTopList()}),333)):this.getOffsetTopListIsDoing=!1},beforeGetOffsetTopList(){this.getOffsetTopListIsDoing||this.getOffsetTopList()}},watch:{resize(){this.beforeGetOffsetTopList()}}};const te=(0,J.Z)(ee,[["render",$],["__scopeId","data-v-0cdacb40"]]);var oe=te}}]);
//# sourceMappingURL=299.216dd605.js.map